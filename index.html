<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ランダムURLオープナー</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        .textarea-wrapper {
            position: relative;
        }
        #urlList {
            width: 100%;
            height: 200px;
            margin-bottom: 10px;
        }
        .line-count {
            position: absolute;
            right: 10px;
            bottom: 5px;
            background: rgba(255, 255, 255, 0.7);
            padding: 2px 5px;
            font-size: 12px;
            color: #666;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>ランダムURLオープナー</h1>
    <div class="textarea-wrapper">
        <textarea id="urlList" placeholder="URLを改行区切りで入力してください"></textarea>
        <div class="line-count" id="lineCount">0行</div>
    </div>
    <br>
    <button id="openRandomUrl">1秒遅延させながら12個開く</button>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const textarea = document.getElementById('urlList');
            const lineCountElement = document.getElementById('lineCount');
            const button = document.getElementById('openRandomUrl');

            // localStorageからデータを読み込む
            const savedUrls = localStorage.getItem('savedUrls');
            if (savedUrls) {
                textarea.value = savedUrls;
                updateLineCount();
            }

            // 行数を更新する関数
            function updateLineCount() {
                const lines = textarea.value.trim().split('\n').filter(line => line.trim() !== '');
                lineCountElement.textContent = `${lines.length}行`;
            }

            // テキストエリアの内容が変わったら行数を更新
            textarea.addEventListener('input', function() {
                updateLineCount();
                localStorage.setItem('savedUrls', textarea.value);
            });

            // ボタンクリック時の処理
            button.addEventListener('click', function() {
                let urls = textarea.value.trim().split('\n').filter(url => url.trim() !== '');

                if (urls.length === 0) {
                    alert('URLが入力されていません');
                    return;
                }

                // 25個または残っているURLの数だけ開く
                const openCount = Math.min(12, urls.length);

                // 0.25秒遅延させながらURLを開く
                for (let i = 0; i < openCount; i++) {
                    setTimeout(() => {
                        if (urls.length > 0) {
                            const randomIndex = Math.floor(Math.random() * urls.length);
                            const selectedUrl = urls[randomIndex];
                            window.open(selectedUrl, '_blank');
                            urls.splice(randomIndex, 1);
                            textarea.value = urls.join('\n');
                            updateLineCount();
                            localStorage.setItem('savedUrls', textarea.value);
                        }
                    }, 1000 * i);
                }
            });
        });
    </script>
</body>
</html>
